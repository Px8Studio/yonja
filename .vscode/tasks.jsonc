{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸš€ Start All",
      "detail": "Quality checks â†’ Stop existing â†’ Clear cache â†’ Docker â†’ API + UI + LangGraph",
      "dependsOn": [
        "ğŸ›¡ï¸ Pre-Start Quality Checks",
        "yonca:cleanup",
        "ğŸŒ¿ Yonca AI: ğŸ§¹ Clear Browser Cache",
        "ğŸŒ¿ Yonca AI: ğŸ³ Docker Start",
        "ğŸŒ¿ Yonca AI: âš¡ FastAPI Start",
        "ğŸŒ¿ Yonca AI: ğŸ–¥ï¸ UI Start",
        "ğŸŒ¿ Yonca AI: ğŸ¨ LangGraph Start"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": [],
      "runOptions": { "runOn": "default" }
    },
    {
      "label": "ğŸ›¡ï¸ Pre-Start Quality Checks",
      "detail": "Run lint + import + test checks before starting services",
      "type": "shell",
      "command": "pwsh",
      "args": ["-File", "${workspaceFolder}/scripts/pre-start-checks.ps1"],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared", "clear": true }
    },
    {
      "label": "yonca:cleanup",
      "detail": "Kill existing processes to free ports",
      "type": "shell",
      "command": "pwsh",
      "args": ["-Command", "Get-Process python,chainlit,langgraph -ErrorAction SilentlyContinue | Stop-Process -Force; Write-Host 'ğŸ§¹ Ports cleared' -ForegroundColor Green"],
      "problemMatcher": [],
      "presentation": { "reveal": "silent", "panel": "shared" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ›‘ Stop All",
      "detail": "Stop all services + Docker containers",
      "type": "shell",
      "command": "pwsh",
      "args": ["-Command", "Write-Host 'ğŸ›‘ Stopping services...' -ForegroundColor Yellow; Get-Process -Name python,chainlit,langgraph -ErrorAction SilentlyContinue | Stop-Process -Force; docker-compose -f docker-compose.local.yml down; Write-Host 'âœ… All stopped' -ForegroundColor Green"],
      "options": { "cwd": "${workspaceFolder}" },
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ³ Docker Start",
      "detail": "Running ğŸ˜ PostgreSQL + ğŸ¦™ Ollama + ğŸ”´ Redis + ğŸ“Š Langfuse infrastructure",
      "type": "shell",
      "command": "docker-compose",
      "args": ["-f", "docker-compose.local.yml", "up", "-d", "postgres", "ollama", "redis", "langfuse-db", "langfuse-server"],
      "options": { "cwd": "${workspaceFolder}" },
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared", "clear": true }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ³ Docker Stop",
      "detail": "Stop all Docker containers",
      "type": "shell",
      "command": "docker-compose",
      "args": ["-f", "docker-compose.local.yml", "down"],
      "options": { "cwd": "${workspaceFolder}" },
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ³ Docker Status",
      "detail": "Show container health",
      "type": "shell",
      "command": "docker-compose",
      "args": ["-f", "docker-compose.local.yml", "ps", "-a"],
      "options": { "cwd": "${workspaceFolder}" },
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ³ Docker Logs",
      "detail": "Stream all container logs (Postgres, Redis, Ollama, Langfuse)",
      "type": "shell",
      "command": "docker-compose",
      "args": ["-f", "docker-compose.local.yml", "logs", "-f", "--tail=50"],
      "options": { "cwd": "${workspaceFolder}" },
      "isBackground": true,
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: âš¡ FastAPI Start",
      "detail": "Running âš¡ FastAPI Backend + Swagger/ReDoc docs (http://localhost:8000)",
      "type": "shell",
      "command": "${workspaceFolder}\\.venv\\Scripts\\python.exe",
      "args": ["-m", "uvicorn", "yonca.api.main:app", "--host", "localhost", "--port", "8000", "--reload", "--log-level", "info"],
      "options": {
        "cwd": "${workspaceFolder}",
        "env": {
          "PYTHONPATH": "${workspaceFolder}/src",
          "DATABASE_URL": "postgresql+asyncpg://yonca:yonca_dev_password@localhost:5433/yonca"
        }
      },
      "isBackground": true,
      "problemMatcher": {
        "owner": "uvicorn",
        "pattern": { "regexp": "^$" },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "Started reloader",
          "endsPattern": "Application startup complete"
        }
      },
      "presentation": { "reveal": "always", "panel": "dedicated", "clear": true }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ–¥ï¸ UI Start",
      "detail": "Running ğŸ’¬ Chainlit Chat + ğŸ“Š Langfuse + ğŸ“– Swagger + ğŸ“• ReDoc (all UIs)",
      "type": "shell",
      "command": "${workspaceFolder}\\demo-ui\\.venv\\Scripts\\chainlit.exe",
      "args": ["run", "app.py", "-w", "--port", "8501", "--headless"],
      "options": {
        "cwd": "${workspaceFolder}/demo-ui",
        "env": {
          "PYTHONPATH": "${workspaceFolder}/src;${workspaceFolder}/demo-ui",
          "INTEGRATION_MODE": "direct",
          "LLM_PROVIDER": "ollama",
          "OLLAMA_BASE_URL": "http://localhost:11434",
          "REDIS_URL": "redis://localhost:6379/0",
          "DATABASE_URL": "postgresql+asyncpg://yonca:yonca_dev_password@localhost:5433/yonca",
          "ENABLE_DATA_PERSISTENCE": "true"
        }
      },
      "isBackground": true,
      "problemMatcher": {
        "owner": "chainlit",
        "pattern": { "regexp": "^$" },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "Your app is available",
          "endsPattern": "Your app is available"
        }
      },
      "presentation": { "reveal": "always", "panel": "dedicated", "clear": true }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ¨ LangGraph Start",
      "detail": "Running ğŸ¤– LangGraph Agent + orchestration (http://localhost:2024)",
      "type": "shell",
      "command": "${workspaceFolder}\\.venv\\Scripts\\langgraph.exe",
      "args": ["dev"],
      "options": {
        "cwd": "${workspaceFolder}",
        "env": { "PYTHONPATH": "${workspaceFolder}/src" }
      },
      "isBackground": true,
      "problemMatcher": {
        "owner": "langgraph",
        "pattern": { "regexp": "^$" },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "Starting",
          "endsPattern": "Ready"
        }
      },
      "presentation": { "reveal": "always", "panel": "dedicated", "clear": true }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸŒ Open All UIs",
      "detail": "Open Swagger + Langfuse + Chat UI",
      "type": "shell",
      "command": "pwsh",
      "args": ["-Command", "Start-Process 'http://localhost:8000/docs'; Start-Process 'http://localhost:3001'; Start-Process 'http://localhost:8501'"],
      "problemMatcher": [],
      "presentation": { "reveal": "silent" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ“– Open Swagger",
      "type": "shell",
      "command": "Start-Process",
      "args": ["http://localhost:8000/docs"],
      "problemMatcher": [],
      "presentation": { "reveal": "silent" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ’¬ Open Chat UI",
      "type": "shell",
      "command": "Start-Process",
      "args": ["http://localhost:8501"],
      "problemMatcher": [],
      "presentation": { "reveal": "silent" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ“Š Open Langfuse",
      "type": "shell",
      "command": "Start-Process",
      "args": ["http://localhost:3001"],
      "problemMatcher": [],
      "presentation": { "reveal": "silent" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ—„ï¸ DB Migrate",
      "detail": "Apply Alembic migrations",
      "type": "shell",
      "command": "${workspaceFolder}\\.venv\\Scripts\\alembic.exe",
      "args": ["upgrade", "head"],
      "options": {
        "cwd": "${workspaceFolder}",
        "env": {
          "PYTHONPATH": "${workspaceFolder}/src",
          "DATABASE_URL": "postgresql+asyncpg://yonca:yonca_dev_password@localhost:5433/yonca"
        }
      },
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ—„ï¸ DB Seed",
      "detail": "Populate with test data",
      "type": "shell",
      "command": "${workspaceFolder}\\.venv\\Scripts\\python.exe",
      "args": ["scripts/seed_database.py"],
      "options": {
        "cwd": "${workspaceFolder}",
        "env": {
          "PYTHONPATH": "${workspaceFolder}/src",
          "DATABASE_URL": "postgresql+asyncpg://yonca:yonca_dev_password@localhost:5433/yonca"
        }
      },
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ—„ï¸ DB New Migration",
      "detail": "Generate migration from model changes",
      "type": "shell",
      "command": "${workspaceFolder}\\.venv\\Scripts\\alembic.exe",
      "args": ["revision", "--autogenerate", "-m", "${input:migrationMessage}"],
      "options": {
        "cwd": "${workspaceFolder}",
        "env": {
          "PYTHONPATH": "${workspaceFolder}/src",
          "DATABASE_URL": "postgresql+asyncpg://yonca:yonca_dev_password@localhost:5433/yonca"
        }
      },
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ§ª Test All",
      "detail": "Run pytest",
      "type": "shell",
      "command": "pytest",
      "args": ["tests/", "-v", "--tb=short"],
      "options": {
        "cwd": "${workspaceFolder}",
        "env": { "PYTHONPATH": "${workspaceFolder}/src" }
      },
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared" },
      "group": "test"
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ” Lint",
      "detail": "Run ruff check",
      "type": "shell",
      "command": "ruff",
      "args": ["check", "src/", "tests/"],
      "options": { "cwd": "${workspaceFolder}" },
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ§¹ Clear Cache",
      "detail": "Remove __pycache__ folders",
      "type": "shell",
      "command": "pwsh",
      "args": ["-Command", "Get-ChildItem -Path . -Recurse -Directory -Filter '__pycache__' | Remove-Item -Recurse -Force -ErrorAction SilentlyContinue; Write-Host 'ğŸ§¹ Cache cleared' -ForegroundColor Green"],
      "options": { "cwd": "${workspaceFolder}" },
      "problemMatcher": [],
      "presentation": { "reveal": "silent" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ§¹ Clear Browser Cache",
      "detail": "Clear Chrome/Edge/Firefox cache (LocalStorage, SessionStorage, IndexedDB)",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-File",
        "${workspaceFolder}/scripts/clear_browser_cache.ps1"
      ],
      "problemMatcher": [],
      "presentation": { "reveal": "silent" }
    },
    {
      "label": "ğŸ§¹ Clear Cache & Ports",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-File",
        "${workspaceFolder}/scripts/clear_browser_cache.ps1"
      ],
      "presentation": {
        "reveal": "silent"
      },
      "runOptions": {
        "runOn": "default"
      }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ¤– Models Setup",
      "detail": "Pull models (run once after Docker Start)",
      "type": "shell",
      "command": "docker-compose",
      "args": ["-f", "docker-compose.local.yml", "--profile", "setup", "up", "model-setup"],
      "options": { "cwd": "${workspaceFolder}" },
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "dedicated" }
    },
    {
      "label": "ğŸŒ¿ Yonca AI: ğŸ¤– Models List",
      "detail": "Show Ollama models",
      "type": "shell",
      "command": "docker",
      "args": ["exec", "yonca-ollama", "ollama", "list"],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared" }
    }
  ],
  "inputs": [
    {
      "id": "migrationMessage",
      "type": "promptString",
      "description": "Migration message (e.g., 'Add user settings')"
    }
  ]
}
